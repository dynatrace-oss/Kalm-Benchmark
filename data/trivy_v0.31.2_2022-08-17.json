{"SchemaVersion": 2, "ArtifactName": "dist", "ArtifactType": "filesystem", "Metadata": {"ImageConfig": {"architecture": "", "created": "0001-01-01T00:00:00Z", "os": "", "rootfs": {"type": "", "diff_ids": null}, "config": {}}}, "Results": [{"Target": "_default-priority-c8fbe908.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "_kalm-benchmark-c882ce07.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "_kalm-benchmark-unrestricted-ns-c849031e.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "cm-001-sensitive-key-referenced-in-configmap.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "np-001-namespace-without-network-policy.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "np-002-1-only-ingress-is-blocked.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "np-002-2-only-egress-is-blocked.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "np-003-network-policy-allows-access-to-cloud-metadata-api.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "np-004-network-policy-allows-access-to-kubelet.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "np-005-network-policy-refers-no-valid-workload.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "ns-001-use-default-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "ns-002-1-place-pod-in-kube-system.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV037", "Title": "User Pods should not be placed in kube-system namespace", "Description": "ensure that User pods are not placed in kube-system namespace", "Message": "Deployment 'ns-002-1-place-pod-in-kube-system' should not be set with 'kube-system' namespace", "Namespace": "builtin.kubernetes.KSV037", "Query": "data.builtin.kubernetes.KSV037.deny", "Resolution": "Deploy the use pods into a designated namespace which is not kube-system.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv037", "References": ["https://kubernetes.io/docs/reference/setup-tools/kubeadm/implementation-details/", "https://avd.aquasec.com/misconfig/ksv037"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 89, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .metadata.namespace", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: azure should not be used for custom workloads", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: NS-002-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: ns-002-1-place-pod-in-kube-system", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kube-system", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "ns-002-2-place-pod-in-kube-public.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-002-1-explicit-default-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-002-2-no-sa-specified.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-003-1-default-pod-and-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-003-2-default-pod-automount-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-003-3-default-pod-no-automount-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-003-4-automount-pod-default-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-003-5-automount-pod-and-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-003-6-automount-pod-no-automount-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-003-7-no-automount-pod-default-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-003-8-no-automount-pod-automount-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-003-9-no-automount-pod-and-sa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-008-1-use-no-hostpid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-008-2-pod-has-hostpid-set.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV010", "Title": "Access to host PID", "Description": "Sharing the host\u2019s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.", "Message": "Deployment 'pod-008-2-pod-has-hostpid-set' should not set 'spec.template.spec.hostPID' to true", "Namespace": "builtin.kubernetes.KSV010", "Query": "data.builtin.kubernetes.KSV010.deny", "Resolution": "Do not set 'spec.template.spec.hostPID' to true.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv010", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv010"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 89, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.hostPID", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: Containers should be isolated from the host machine as much as possible. `hostPID` pods may allow cross-container influence and may expose the host itself to potentially malicious or destructive actions", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-008-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-008-2-pod-has-hostpid-set", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-009-1-use-no-hostipc.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-009-2-has-hostipc-set.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV008", "Title": "Access to host IPC namespace", "Description": "Sharing the host\u2019s IPC namespace allows container processes to communicate with processes on the host.", "Message": "Deployment 'pod-009-2-has-hostipc-set' should not set 'spec.template.spec.hostIPC' to true", "Namespace": "builtin.kubernetes.KSV008", "Query": "data.builtin.kubernetes.KSV008.deny", "Resolution": "Do not set 'spec.template.spec.hostIPC' to true.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv008", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv008"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 89, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.hostIPC", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: Containers should be isolated from the host machine as much as possible. `hostIPC` on pods may allow cross-container influence and may expose the host itself to potentially malicious or destructive actions", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-009-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-009-2-has-hostipc-set", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-010-1-use-no-hostnetwork.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-010-2-has-hostnetwork-set.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV009", "Title": "Access to host network", "Description": "Sharing the host\u2019s network namespace permits processes in the pod to communicate with processes bound to the host\u2019s loopback adapter.", "Message": "Deployment 'pod-010-2-has-hostnetwork-set' should not set 'spec.template.spec.hostNetwork' to true", "Namespace": "builtin.kubernetes.KSV009", "Query": "data.builtin.kubernetes.KSV009.deny", "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv009", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv009"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 89, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.hostNetwork", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: Containers should be isolated from the host machine as much as possible.", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-010-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-010-2-has-hostnetwork-set", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-011-uses-hostport.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV024", "Title": "Access to host ports", "Description": "HostPorts should be disallowed, or at minimum restricted to a known list.", "Message": "Container 'app' of Deployment 'pod-011-uses-hostport' should not set host ports, 'ports[*].hostPort'", "Namespace": "builtin.kubernetes.KSV024", "Query": "data.builtin.kubernetes.KSV024.deny", "Resolution": "Do not set spec.containers[*].ports[*].hostPort and spec.initContainers[*].ports[*].hostPort.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv024", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv024"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 75, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-012-use-hostaliases-to-modify-pods--etc-hosts.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-013-use-serviceaccount-field.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-014-no-apparmor-profile.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-016-no-podsecuritycontext-defined.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-017-1-default-to-root-user.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV012", "Title": "Runs as root user", "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.", "Message": "Container 'app' of Deployment 'pod-017-1-default-to-root-user' should set 'securityContext.runAsNonRoot' to true", "Namespace": "builtin.kubernetes.KSV012", "Query": "data.builtin.kubernetes.KSV012.deny", "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv012"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 72, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-1-default-to-root-user' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 72, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-017-2-use-runasnonroot-flag-on-pod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-2-use-runasnonroot-flag-on-pod' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 72, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-017-3-runasnonroot-is-optional.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV012", "Title": "Runs as root user", "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.", "Message": "Container 'app' of Deployment 'pod-017-3-runasnonroot-is-optional' should set 'securityContext.runAsNonRoot' to true", "Namespace": "builtin.kubernetes.KSV012", "Query": "data.builtin.kubernetes.KSV012.deny", "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv012"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 72, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-3-runasnonroot-is-optional' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 72, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-017-4-use-root-user-in-pod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV012", "Title": "Runs as root user", "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.", "Message": "Container 'app' of Deployment 'pod-017-4-use-root-user-in-pod' should set 'securityContext.runAsNonRoot' to true", "Namespace": "builtin.kubernetes.KSV012", "Query": "data.builtin.kubernetes.KSV012.deny", "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv012"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 72, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-4-use-root-user-in-pod' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 72, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-017-5-use-runasnonroot-flag-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-5-use-runasnonroot-flag-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-017-6-runasnonroot-is-optional-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV012", "Title": "Runs as root user", "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.", "Message": "Container 'app' of Deployment 'pod-017-6-runasnonroot-is-optional-on-container' should set 'securityContext.runAsNonRoot' to true", "Namespace": "builtin.kubernetes.KSV012", "Query": "data.builtin.kubernetes.KSV012.deny", "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv012"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-6-runasnonroot-is-optional-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-017-7-use-root-user-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV012", "Title": "Runs as root user", "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.", "Message": "Container 'app' of Deployment 'pod-017-7-use-root-user-on-container' should set 'securityContext.runAsNonRoot' to true", "Namespace": "builtin.kubernetes.KSV012", "Query": "data.builtin.kubernetes.KSV012.deny", "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv012", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv012"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-7-use-root-user-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-017-8-set-runasnonroot-correctly-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-8-set-runasnonroot-correctly-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-017-9-set-runasnonroot-not-correctly-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-017-9-set-runasnonroot-not-correctly-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-018-1-default-to-root-user.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-018-1-default-to-root-user' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-018-2-use-uid-between-1k-10k-on-pod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-018-2-use-uid-between-1k-10k-on-pod' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-018-3-use-uid-between-1k-10k-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-018-3-use-uid-between-1k-10k-on-container' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 74, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-018-4-use-uid-set-in-container-takes-precedence.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-018-4-use-uid-set-in-container-takes-precedence' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 74, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV105", "Title": "Containers must not set runAsUser to 0", "Description": "Containers should be forbidden from running with a root UID.", "Message": "securityContext.runAsUser should be set to a value greater than 0", "Namespace": "builtin.kubernetes.KSV105", "Query": "data.builtin.kubernetes.KSV105.deny", "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv105"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 82, "EndLine": 88, "Code": {"Lines": [{"Number": 82, "Content": "              level: s0:c123,c456", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 83, "Content": "            seccompProfile:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 84, "Content": "              type: RuntimeDefault", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 85, "Content": "      hostIPC: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 86, "Content": "      hostNetwork: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 87, "Content": "      hostPID: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 88, "Content": "      nodeSelector:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-018-5-use-uid-set-in-container-takes-precedence.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV020", "Title": "Runs with low user ID", "Description": "Force the container to run with user ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-018-5-use-uid-set-in-container-takes-precedence' should set 'securityContext.runAsUser' > 10000", "Namespace": "builtin.kubernetes.KSV020", "Query": "data.builtin.kubernetes.KSV020.deny", "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv020", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv020"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 74, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV105", "Title": "Containers must not set runAsUser to 0", "Description": "Containers should be forbidden from running with a root UID.", "Message": "securityContext.runAsUser should be set to a value greater than 0", "Namespace": "builtin.kubernetes.KSV105", "Query": "data.builtin.kubernetes.KSV105.deny", "Resolution": "Set 'securityContext.runAsUser' to a non-zero integer or leave undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv105", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv105"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 62, "EndLine": 74, "Code": {"Lines": [{"Number": 62, "Content": "          resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 63, "Content": "            limits:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 68, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 69, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 70, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 71, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-019-1-default-to-root-group.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV021", "Title": "Runs with low group ID", "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-019-1-default-to-root-group' should set 'securityContext.runAsGroup' > 10000", "Namespace": "builtin.kubernetes.KSV021", "Query": "data.builtin.kubernetes.KSV021.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv021"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-019-2-use-gid-between-1k-10k-on-pod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV021", "Title": "Runs with low group ID", "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-019-2-use-gid-between-1k-10k-on-pod' should set 'securityContext.runAsGroup' > 10000", "Namespace": "builtin.kubernetes.KSV021", "Query": "data.builtin.kubernetes.KSV021.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv021"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-019-3-use-gid-between-1k-10k-on-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV021", "Title": "Runs with low group ID", "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-019-3-use-gid-between-1k-10k-on-container' should set 'securityContext.runAsGroup' > 10000", "Namespace": "builtin.kubernetes.KSV021", "Query": "data.builtin.kubernetes.KSV021.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv021"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 74, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-019-4-use-gid-set-in-container-takes-precedence.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV021", "Title": "Runs with low group ID", "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-019-4-use-gid-set-in-container-takes-precedence' should set 'securityContext.runAsGroup' > 10000", "Namespace": "builtin.kubernetes.KSV021", "Query": "data.builtin.kubernetes.KSV021.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv021"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 74, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-019-5-use-gid-set-in-container-takes-precedence.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV021", "Title": "Runs with low group ID", "Description": "Force the container to run with group ID > 10000 to avoid conflicts with the host\u2019s user table.", "Message": "Container 'app' of Deployment 'pod-019-5-use-gid-set-in-container-takes-precedence' should set 'securityContext.runAsGroup' > 10000", "Namespace": "builtin.kubernetes.KSV021", "Query": "data.builtin.kubernetes.KSV021.deny", "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer > 10000.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv021", "References": ["https://kubesec.io/basics/containers-securitycontext-runasuser/", "https://avd.aquasec.com/misconfig/ksv021"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 74, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-021-0-using-sysctl-kernel.shm-rmid-forced-c808ea91.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-021-1-using-sysctl-net.ipv4.tcp-keepalive-time-c86452e6.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV026", "Title": "Unsafe sysctl options set", "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.", "Message": "Deployment 'pod-021-1-using-sysctl-net.ipv4.tcp-keepalive-time' should set 'securityContext.sysctl' to the allowed values", "Namespace": "builtin.kubernetes.KSV026", "Query": "data.builtin.kubernetes.KSV026.deny", "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv026", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv026"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 92, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.securityContext.sysctls[]", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: Giving dangerous capabilities to a container increases the impact of a container compromise", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-021-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-021-1-using-sysctl-net.ipv4.tcp-keepalive-time", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-021-2-using-sysctl-net.ipv4.tcp-keepalive-probes-c83975aa.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV026", "Title": "Unsafe sysctl options set", "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.", "Message": "Deployment 'pod-021-2-using-sysctl-net.ipv4.tcp-keepalive-probes' should set 'securityContext.sysctl' to the allowed values", "Namespace": "builtin.kubernetes.KSV026", "Query": "data.builtin.kubernetes.KSV026.deny", "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv026", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv026"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 92, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.securityContext.sysctls[]", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: Giving dangerous capabilities to a container increases the impact of a container compromise", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-021-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-021-2-using-sysctl-net.ipv4.tcp-keepalive-probes", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-022-1-linux-is-not-hardened.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV030", "Title": "Default Seccomp profile not set", "Description": "The RuntimeDefault/Localhost seccomp profile must be required, or allow specific additional profiles.", "Message": "Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'", "Namespace": "builtin.kubernetes.KSV030", "Query": "data.builtin.kubernetes.KSV030.deny", "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv030", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv030"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 36, "EndLine": 67, "Code": {"Lines": [{"Number": 36, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 37, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 38, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 39, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 40, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 45, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-022-2-one-approach-to-hardening-linux-is-enough.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-022-3-one-approach-to-hardening-linux-is-enough.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-023-no-seccomp-profile-defined.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-024-0-usage-of-bin-bash-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-024-1-usage-of-sbin-sh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-024-2-usage-of-bin-ksh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-024-3-usage-of-bin-tcsh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-024-4-usage-of-bin-zsh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-024-5-usage-of-usr-bin-scsh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-024-6-usage-of-bin-csh-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-024-7-usage-of-bin-busybox-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-024-8-usage-of-usr-bin-busybox-in-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-025-sensitive-key-referenced-in-environment-variable.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-030-no-securitycontext-defined.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-031-1-allowed-privilege-escalation-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV001", "Title": "Process can elevate its own privileges", "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.", "Message": "Container 'app' of Deployment 'pod-031-1-allowed-privilege-escalation-by-default' should set 'securityContext.allowPrivilegeEscalation' to false", "Namespace": "builtin.kubernetes.KSV001", "Query": "data.builtin.kubernetes.KSV001.deny", "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv001"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-031-2-allowed-privilege-escalation-explicitly.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV001", "Title": "Process can elevate its own privileges", "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.", "Message": "Container 'app' of Deployment 'pod-031-2-allowed-privilege-escalation-explicitly' should set 'securityContext.allowPrivilegeEscalation' to false", "Namespace": "builtin.kubernetes.KSV001", "Query": "data.builtin.kubernetes.KSV001.deny", "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv001"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 74, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-032-1-non-privileged-container-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "pod-032-2-privileged-container.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV001", "Title": "Process can elevate its own privileges", "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.", "Message": "Container 'app' of Deployment 'pod-032-2-privileged-container' should set 'securityContext.allowPrivilegeEscalation' to false", "Namespace": "builtin.kubernetes.KSV001", "Query": "data.builtin.kubernetes.KSV001.deny", "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv001"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV017", "Title": "Privileged container", "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.", "Message": "Container 'app' of Deployment 'pod-032-2-privileged-container' should set 'securityContext.privileged' to false", "Namespace": "builtin.kubernetes.KSV017", "Query": "data.builtin.kubernetes.KSV017.deny", "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv017", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv017"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-033-1-root-fs-is-writeable-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV014", "Title": "Root file system is not read-only", "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.", "Message": "Container 'app' of Deployment 'pod-033-1-root-fs-is-writeable-by-default' should set 'securityContext.readOnlyRootFilesystem' to true", "Namespace": "builtin.kubernetes.KSV014", "Query": "data.builtin.kubernetes.KSV014.deny", "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014", "References": ["https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/", "https://avd.aquasec.com/misconfig/ksv014"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-033-2-root-fs-is-explicitly-writeable.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV014", "Title": "Root file system is not read-only", "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.", "Message": "Container 'app' of Deployment 'pod-033-2-root-fs-is-explicitly-writeable' should set 'securityContext.readOnlyRootFilesystem' to true", "Namespace": "builtin.kubernetes.KSV014", "Query": "data.builtin.kubernetes.KSV014.deny", "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv014", "References": ["https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/", "https://avd.aquasec.com/misconfig/ksv014"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 74, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-034-1-using-dangerous-capability-all.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-034-1-using-dangerous-capability-all' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-034-2-using-dangerous-capability-sys-admin.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 3, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV005", "Title": "SYS_ADMIN capability added", "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.", "Message": "Container 'app' of Deployment 'pod-034-2-using-dangerous-capability-sys-admin' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV005", "Query": "data.builtin.kubernetes.KSV005.deny", "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv005", "References": ["https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/", "https://avd.aquasec.com/misconfig/ksv005"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-034-2-using-dangerous-capability-sys-admin' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-034-3-using-dangerous-capability-net-admin.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-034-3-using-dangerous-capability-net-admin' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-1-using-insecure-capability-audit-write.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-1-using-insecure-capability-audit-write' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-10-using-insecure-capability-mknod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-10-using-insecure-capability-mknod' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-11-using-insecure-capability-net-bind-service.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-11-using-insecure-capability-net-bind-service' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-035-12-using-insecure-capability-net-raw.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-12-using-insecure-capability-net-raw' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-13-using-insecure-capability-perfmon.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-13-using-insecure-capability-perfmon' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-14-using-insecure-capability-setfcap.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-14-using-insecure-capability-setfcap' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-15-using-insecure-capability-setgid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-15-using-insecure-capability-setgid' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-16-using-insecure-capability-setpcap.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-16-using-insecure-capability-setpcap' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-17-using-insecure-capability-setuid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-17-using-insecure-capability-setuid' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-18-using-insecure-capability-sys-boot.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-18-using-insecure-capability-sys-boot' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-19-using-insecure-capability-sys-chroot.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-19-using-insecure-capability-sys-chroot' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-2-using-insecure-capability-bpf.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-2-using-insecure-capability-bpf' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-20-using-insecure-capability-sys-module.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-20-using-insecure-capability-sys-module' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-21-using-insecure-capability-sys-rawio.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-21-using-insecure-capability-sys-rawio' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-22-using-insecure-capability-sys-ptrace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-22-using-insecure-capability-sys-ptrace' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-3-using-insecure-capability-chown.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-3-using-insecure-capability-chown' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-4-using-insecure-capability-dac-overrides.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-4-using-insecure-capability-dac-overrides' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-5-using-insecure-capability-fowner.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-5-using-insecure-capability-fowner' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-6-using-insecure-capability-fsetid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-6-using-insecure-capability-fsetid' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-7-using-insecure-capability-kill.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-7-using-insecure-capability-kill' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-8-using-insecure-capability-mac-override.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-8-using-insecure-capability-mac-override' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-035-9-using-insecure-capability-mac-admin.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV022", "Title": "Non-default capabilities added", "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.", "Message": "Container 'app' of Deployment 'pod-035-9-using-insecure-capability-mac-admin' should not set 'securityContext.capabilities.add'", "Namespace": "builtin.kubernetes.KSV022", "Query": "data.builtin.kubernetes.KSV022.deny", "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv022", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv022"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 76, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should not add stuff", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 64, "EndLine": 67, "Code": {"Lines": [{"Number": 64, "Content": "              cpu: 1m", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 65, "Content": "              ephemeral-storage: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 66, "Content": "              memory: 1Mi", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 67, "Content": "            requests:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "pod-036-keep-default-capabilities.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV003", "Title": "Default capabilities not dropped", "Description": "The container should drop all default capabilities and add only those that are needed for its execution.", "Message": "Container 'app' of Deployment 'pod-036-keep-default-capabilities' should add 'ALL' to 'securityContext.capabilities.drop'", "Namespace": "builtin.kubernetes.KSV003", "Query": "data.builtin.kubernetes.KSV003.deny", "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003", "References": ["https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/", "https://avd.aquasec.com/misconfig/ksv003"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 72, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV106", "Title": "Container capabilities must only include NET_BIND_SERVICE", "Description": "Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.", "Message": "container should drop all", "Namespace": "builtin.kubernetes.KSV106", "Query": "data.builtin.kubernetes.KSV106.deny", "Resolution": "Set 'spec.containers[*].securityContext.capabilities.drop' to 'ALL' and only add 'NET_BIND_SERVICE' to 'spec.containers[*].securityContext.capabilities.add'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv106", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted", "https://avd.aquasec.com/misconfig/ksv106"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 72, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-042-1-volume-with-read-only-hostpath.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV023", "Title": "hostPath volumes mounted", "Description": "HostPath volumes must be forbidden.", "Message": "Deployment 'pod-042-1-volume-with-read-only-hostpath' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 97, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.volumes[]|.spec.volumes[].hostPath|.spec.volumes[].hostPath.path|.spec.containers[].volumeMounts[]", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: using hostPath is not ideal but can be tolerated when it's read-only", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: pass", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-042-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-042-1-volume-with-read-only-hostpath", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-042-2-volume-with-writeable-hostpath.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV023", "Title": "hostPath volumes mounted", "Description": "HostPath volumes must be forbidden.", "Message": "Deployment 'pod-042-2-volume-with-writeable-hostpath' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 97, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.volumes[]|.spec.volumes[].hostPath|.spec.volumes[].hostPath.path|.spec.containers[].volumeMounts[]", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: Attackers can use a writable hostpath to gain persistence on underlying host system", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-042-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-042-2-volume-with-writeable-hostpath", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-042-3-volume-with-writeable-hostpath-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV023", "Title": "hostPath volumes mounted", "Description": "HostPath volumes must be forbidden.", "Message": "Deployment 'pod-042-3-volume-with-writeable-hostpath-by-default' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 96, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.volumes[]|.spec.volumes[].hostPath|.spec.volumes[].hostPath.path|.spec.containers[].volumeMounts[]", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: Attackers can use a writable hostpath to gain persistence on underlying host system", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-042-3", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-042-3-volume-with-writeable-hostpath-by-default", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-043-1-mount-azure-cloud-credentials.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV023", "Title": "hostPath volumes mounted", "Description": "HostPath volumes must be forbidden.", "Message": "Deployment 'pod-043-1-mount-azure-cloud-credentials' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 98, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.volumes[]|.spec.volumes[].hostPath|.spec.volumes[].hostPath.path|.spec.containers[].volumeMounts[]", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: Mounting Docker socket (Unix socket) enables container to access Docker internals, retrieve sensitive information and execute Docker commands.", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-043-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-043-1-mount-azure-cloud-credentials", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-044-1-mounting-docker-socket.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV006", "Title": "hostPath volume mounted with docker.sock", "Description": "Mounting docker.sock from the host can give the container full root access to the host.", "Message": "Deployment 'pod-044-1-mounting-docker-socket' should not specify '/var/run/docker.socker' in 'spec.template.volumes.hostPath.path'", "Namespace": "builtin.kubernetes.KSV006", "Query": "data.builtin.kubernetes.KSV006.deny", "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv006", "References": ["https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/", "https://avd.aquasec.com/misconfig/ksv006"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 97, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.volumes[]|.spec.volumes[].hostPath|.spec.volumes[].hostPath.path|.spec.containers[].volumeMounts[]", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: Mounting Docker socket (Unix socket) enables container to access Docker internals, retrieve sensitive information and execute Docker commands.", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-044-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-044-1-mounting-docker-socket", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Kubernetes Security Check", "ID": "KSV023", "Title": "hostPath volumes mounted", "Description": "HostPath volumes must be forbidden.", "Message": "Deployment 'pod-044-1-mounting-docker-socket' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 97, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.volumes[]|.spec.volumes[].hostPath|.spec.volumes[].hostPath.path|.spec.containers[].volumeMounts[]", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: Mounting Docker socket (Unix socket) enables container to access Docker internals, retrieve sensitive information and execute Docker commands.", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-044-1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-044-1-mounting-docker-socket", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-044-2-mounting-docker-directory.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV023", "Title": "hostPath volumes mounted", "Description": "HostPath volumes must be forbidden.", "Message": "Deployment 'pod-044-2-mounting-docker-directory' should not set 'spec.template.volumes.hostPath'", "Namespace": "builtin.kubernetes.KSV023", "Query": "data.builtin.kubernetes.KSV023.deny", "Resolution": "Do not set 'spec.volumes[*].hostPath'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv023", "References": ["https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline", "https://avd.aquasec.com/misconfig/ksv023"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 14, "EndLine": 97, "Code": {"Lines": [{"Number": 14, "Content": "  annotations:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "    check_path: .spec.volumes[]|.spec.volumes[].hostPath|.spec.volumes[].hostPath.path|.spec.containers[].volumeMounts[]", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    description: mounting Docker socket (Unix socket) enables container to access Docker internals, retrieve sensitive information and execute Docker commands.", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "    expected: alert", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "  labels:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "    app.kubernetes.io/part-of: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "    check: POD-044-2", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "  name: pod-044-2-mounting-docker-directory", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "  namespace: kalm-benchmark", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "pod-045-containing-cve-2021-25741.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-001-1-allow-privileged-containers.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-001-2-allow-privileged-containers-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-002-1-allow-privilege-escalation-in-containers.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-002-2-allow-privilege-escalation-in-containers-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-003-1-allow-pods-sharing-hostpid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-003-2-allow-pods-sharing-hostpid-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-004-1-allow-pods-sharing-hostipc-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-004-2-allow-pods-sharing-hostipc-namespace-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-005-1-allow-pods-sharing-host-network.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-005-2-allow-pods-sharing-host-network-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-006-1-allow-all-host-paths-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-006-2-allow-all-host-paths-naive-specification.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-006-3-disallow-all-host-paths-properly.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-007-1-allow-root-users-in-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-007-2-allow-root-users-in-pods-uid-range.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-007-3-don-t-allow-root-users-in-pods.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-008-1-allow-root-groups-in-pods-must-gid-range.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-008-2-allow-root-groups-in-pods-may-gid-range.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-008-3-allow-root-groups-in-pods-may-higher-gid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-008-4-allow-root-groups-in-pods-must-higher-gid.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-009-allowing-net-raw.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-010-not-dropping-all-capabilities.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-011-1-allowing-read-only-root-filesystem.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-011-2-allowing-read-only-root-filesystem.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-012-not-configuring-se-linux.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-013-1-not-configuring-apparmor-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-013-2-not-confining-apparmor.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-013-3-not-restricting-allowed-apparmor-profiles.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-014-1-not-configuring-seccomp-by-default.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-014-2-not-confining-seccomp.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "psp-014-3-not-restricting-allowed-seccomp-profiles.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-001-1-use-cluster-admin-role.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-001-2-use-cluster-admin-role-cluster-wide.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-002-1-read-access-to-secrets.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - get", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-002-2-read-access-to-secrets.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - list", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-002-3-read-access-to-secrets.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - watch", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-002-4-read-access-to-secrets.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - get", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-002-5-read-access-to-secrets.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - list", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-002-6-read-access-to-secrets.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - watch", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-003-1-role-use-resource-wildcard.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV046", "Title": "No wildcard resource roles", "Description": "Check whether role permits specific verb on wildcard resources", "Message": "Role permits specific verb on wildcard resource", "Namespace": "builtin.kubernetes.KSV046", "Query": "data.builtin.kubernetes.KSV046.deny", "Resolution": "Create a role which does not permit specific verb on wildcard resources", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv046", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv046"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - get", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-003-2-cluster-role-use-resource-wildcard.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV046", "Title": "No wildcard resource roles", "Description": "Check whether role permits specific verb on wildcard resources", "Message": "Role permits specific verb on wildcard resource", "Namespace": "builtin.kubernetes.KSV046", "Query": "data.builtin.kubernetes.KSV046.deny", "Resolution": "Create a role which does not permit specific verb on wildcard resources", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv046", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv046"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - get", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-003-3-role-use-verb-wildcard.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 14, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV045", "Title": "No wildcard verb roles", "Description": "Check whether role permits wildcard verb on specific resources", "Message": "Role permits wildcard verb on specific resources", "Namespace": "builtin.kubernetes.KSV045", "Query": "data.builtin.kubernetes.KSV045.deny", "Resolution": "Create a role which does not permit wildcard verb on specific resources", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv045", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv045"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - jobs", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Rbac Security Check", "ID": "KSV048", "Title": "Do not allow update/create of a malicious pod", "Description": "Check whether role permits update/create of a malicious pod", "Message": "Role permits create/update of a malicious pod", "Namespace": "builtin.kubernetes.KSV048", "Query": "data.builtin.kubernetes.KSV048.deny", "Resolution": "Create a role which does not permit update/create of a malicious pod", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv048", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv048"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - jobs", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-003-4-cluster-role-use-verb-wildcard.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 14, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV045", "Title": "No wildcard verb roles", "Description": "Check whether role permits wildcard verb on specific resources", "Message": "Role permits wildcard verb on specific resources", "Namespace": "builtin.kubernetes.KSV045", "Query": "data.builtin.kubernetes.KSV045.deny", "Resolution": "Create a role which does not permit wildcard verb on specific resources", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv045", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv045"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - jobs", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}, {"Type": "Rbac Security Check", "ID": "KSV048", "Title": "Do not allow update/create of a malicious pod", "Description": "Check whether role permits update/create of a malicious pod", "Message": "Role permits create/update of a malicious pod", "Namespace": "builtin.kubernetes.KSV048", "Query": "data.builtin.kubernetes.KSV048.deny", "Resolution": "Create a role which does not permit update/create of a malicious pod", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv048", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv048"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - jobs", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - \"*\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-003-5-role-use-verb-wildcard.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-003-6-cluster-role-use-verb-wildcard.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-004-1-role-creates-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-004-2-cluster-role-creates-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-005-1-role-attaches-to-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-005-2-cluster-role-attaches-to-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-006-1-role-exec-into-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-006-2-cluster-role-exec-into-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-007-1-role-binds-default-serviceaccount.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-007-2-cluster-role-binds-default-serviceaccount.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-008-1-role-port-forward-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-008-2-role-port-forward-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-008-3-role-port-forward-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-008-4-cluster-role-port-forward-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-008-5-cluster-role-port-forward-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-008-6-cluster-role-port-forward-pods.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-009-1-role-impersonation.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-009-2-cluster-role-impersonation.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-010-1-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-010-2-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-010-3-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-010-4-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-010-5-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-010-6-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-010-7-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-010-8-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-012-1-role-info-disclosure.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "rbac-012-2-role-info-disclosure.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "rbac-012-3-role-info-disclosure.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "rbac-012-4-cluster-role-info-disclosure.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "rbac-012-5-cluster-role-info-disclosure.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "rbac-012-6-cluster-role-info-disclosure.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "rbac-013-1-role-destructive.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 14, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Rbac Security Check", "ID": "KSV056", "Title": "Do not allow management of networking resources", "Description": "The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.", "Message": "Role 'rbac-013-1-role-destroy-resources' should not have access to resources [\"services\", \"endpoints\", \"endpointslices\", \"networkpolicies\", \"ingresses\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV056", "Query": "data.builtin.kubernetes.KSV056.deny", "Resolution": "Networking resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv056", "References": ["https://avd.aquasec.com/misconfig/ksv056"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "rbac-013-2-role-destructive.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 14, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Rbac Security Check", "ID": "KSV056", "Title": "Do not allow management of networking resources", "Description": "The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.", "Message": "Role 'rbac-013-2-role-destroy-resources' should not have access to resources [\"services\", \"endpoints\", \"endpointslices\", \"networkpolicies\", \"ingresses\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV056", "Query": "data.builtin.kubernetes.KSV056.deny", "Resolution": "Networking resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv056", "References": ["https://avd.aquasec.com/misconfig/ksv056"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "rbac-013-3-cluster-role-destructive.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 14, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Rbac Security Check", "ID": "KSV056", "Title": "Do not allow management of networking resources", "Description": "The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.", "Message": "ClusterRole 'rbac-013-3-cluster-role-destroy-resources' should not have access to resources [\"services\", \"endpoints\", \"endpointslices\", \"networkpolicies\", \"ingresses\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV056", "Query": "data.builtin.kubernetes.KSV056.deny", "Resolution": "Networking resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv056", "References": ["https://avd.aquasec.com/misconfig/ksv056"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "rbac-013-4-cluster-role-destructive.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 14, "Failures": 2, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV041", "Title": "Do not allow management of secrets", "Description": "Check whether role permits managing secrets", "Message": "Role permits management of secret(s)", "Namespace": "builtin.kubernetes.KSV041", "Query": "data.builtin.kubernetes.KSV041.deny", "Resolution": "Create a role which does not permit to manage secrets if not needed", "Severity": "CRITICAL", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv041", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv041"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}, {"Type": "Rbac Security Check", "ID": "KSV056", "Title": "Do not allow management of networking resources", "Description": "The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.", "Message": "ClusterRole 'rbac-013-4-cluster-role-destroy-resources' should not have access to resources [\"services\", \"endpoints\", \"endpointslices\", \"networkpolicies\", \"ingresses\"] for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV056", "Query": "data.builtin.kubernetes.KSV056.deny", "Resolution": "Networking resources are only allowed for verbs 'list', 'watch', 'get'", "Severity": "HIGH", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv056", "References": ["https://avd.aquasec.com/misconfig/ksv056"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 27, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - secrets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "      - pods", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - services", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 20, "Content": "      - deployments", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 21, "Content": "      - replicasets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 22, "Content": "      - daemonsets", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 23, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "rbac-014-1-role-event-deletion.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-014-2-role-event-deletion.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-014-3-cluster-role-event-deletion.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-014-4-cluster-role-event-deletion.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-015-1-role-core-dns-poisoning.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV049", "Title": "Do not allow management of configmaps", "Description": "Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.", "Message": "Role 'rbac-015-1-role-poison-dns' should not have access to resource 'configmaps' for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV049", "Query": "data.builtin.kubernetes.KSV049.deny", "Resolution": "Remove write permission verbs for resource 'configmaps'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv049", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv049"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - configmaps", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - update", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-015-2-role-core-dns-poisoning.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV049", "Title": "Do not allow management of configmaps", "Description": "Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.", "Message": "Role 'rbac-015-2-role-poison-dns' should not have access to resource 'configmaps' for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV049", "Query": "data.builtin.kubernetes.KSV049.deny", "Resolution": "Remove write permission verbs for resource 'configmaps'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv049", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv049"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - configmaps", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - patch", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-015-3-cluster-role-core-dns-poisoning.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV049", "Title": "Do not allow management of configmaps", "Description": "Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.", "Message": "ClusterRole 'rbac-015-3-cluster-role-poison-dns' should not have access to resource 'configmaps' for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV049", "Query": "data.builtin.kubernetes.KSV049.deny", "Resolution": "Remove write permission verbs for resource 'configmaps'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv049", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv049"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - configmaps", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - update", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-015-4-cluster-role-core-dns-poisoning.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 15, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Rbac Security Check", "ID": "KSV049", "Title": "Do not allow management of configmaps", "Description": "Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.", "Message": "ClusterRole 'rbac-015-4-cluster-role-poison-dns' should not have access to resource 'configmaps' for verbs [\"create\", \"update\", \"patch\", \"delete\", \"deletecollection\", \"impersonate\", \"*\"]", "Namespace": "builtin.kubernetes.KSV049", "Query": "data.builtin.kubernetes.KSV049.deny", "Resolution": "Remove write permission verbs for resource 'configmaps'", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv049", "References": ["https://kubernetes.io/docs/concepts/security/rbac-good-practices/", "https://avd.aquasec.com/misconfig/ksv049"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Rbac", "Service": "general", "StartLine": 14, "EndLine": 19, "Code": {"Lines": [{"Number": 14, "Content": "  - apiGroups:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 15, "Content": "      - \"\"", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 16, "Content": "    resources:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 17, "Content": "      - configmaps", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 18, "Content": "    verbs:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 19, "Content": "      - patch", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}]}}}]}, {"Target": "rbac-016-serviceaccount-without-binding.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-017-too-many-roles-per-subject.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-020-1-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-020-2-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-020-3-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-020-4-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-020-5-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-020-6-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-020-7-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rbac-020-8-cluster-role-manages-rbac.yaml", "Class": "config", "Type": "rbac", "MisconfSummary": {"Successes": 16, "Failures": 0, "Exceptions": 0}}, {"Target": "rel-001-no-readinessprobe.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "rel-002-no-livenessprobe.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "rel-003-no-priorityclass.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "rel-004-1-no-node-selection-specified.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "rel-004-2-only-nodeaffinity-is-enough.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "rel-004-3-only-nodeselector-is-enough.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-001-1-default-memory-requests-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV016", "Title": "Memory requests not specified", "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.", "Message": "Container 'app' of Deployment 'res-001-1-default-memory-requests-from-namespace' should set 'resources.requests.memory'", "Namespace": "builtin.kubernetes.KSV016", "Query": "data.builtin.kubernetes.KSV016.deny", "Resolution": "Set 'containers[].resources.requests.memory'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016", "References": ["https://kubesec.io/basics/containers-resources-limits-memory/", "https://avd.aquasec.com/misconfig/ksv016"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "res-001-2-no-memory-requests.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV016", "Title": "Memory requests not specified", "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.", "Message": "Container 'app' of Deployment 'res-001-2-no-memory-requests' should set 'resources.requests.memory'", "Namespace": "builtin.kubernetes.KSV016", "Query": "data.builtin.kubernetes.KSV016.deny", "Resolution": "Set 'containers[].resources.requests.memory'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv016", "References": ["https://kubesec.io/basics/containers-resources-limits-memory/", "https://avd.aquasec.com/misconfig/ksv016"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "res-002-1-default-memory-limits-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV018", "Title": "Memory not limited", "Description": "Enforcing memory limits prevents DoS via resource exhaustion.", "Message": "Container 'app' of Deployment 'res-002-1-default-memory-limits-from-namespace' should set 'resources.limits.memory'", "Namespace": "builtin.kubernetes.KSV018", "Query": "data.builtin.kubernetes.KSV018.deny", "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018", "References": ["https://kubesec.io/basics/containers-resources-limits-memory/", "https://avd.aquasec.com/misconfig/ksv018"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "res-002-2-no-memory-limits.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV018", "Title": "Memory not limited", "Description": "Enforcing memory limits prevents DoS via resource exhaustion.", "Message": "Container 'app' of Deployment 'res-002-2-no-memory-limits' should set 'resources.limits.memory'", "Namespace": "builtin.kubernetes.KSV018", "Query": "data.builtin.kubernetes.KSV018.deny", "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv018", "References": ["https://kubesec.io/basics/containers-resources-limits-memory/", "https://avd.aquasec.com/misconfig/ksv018"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "res-003-1-default-cpu-requests-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV015", "Title": "CPU requests not specified", "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.", "Message": "Container 'app' of Deployment 'res-003-1-default-cpu-requests-from-namespace' should set 'resources.requests.cpu'", "Namespace": "builtin.kubernetes.KSV015", "Query": "data.builtin.kubernetes.KSV015.deny", "Resolution": "Set 'containers[].resources.requests.cpu'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015", "References": ["https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits", "https://avd.aquasec.com/misconfig/ksv015"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "res-003-2-no-cpu-requests.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV015", "Title": "CPU requests not specified", "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.", "Message": "Container 'app' of Deployment 'res-003-2-no-cpu-requests' should set 'resources.requests.cpu'", "Namespace": "builtin.kubernetes.KSV015", "Query": "data.builtin.kubernetes.KSV015.deny", "Resolution": "Set 'containers[].resources.requests.cpu'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv015", "References": ["https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits", "https://avd.aquasec.com/misconfig/ksv015"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "res-004-1-default-cpu-limits-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV011", "Title": "CPU not limited", "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.", "Message": "Container 'app' of Deployment 'res-004-1-default-cpu-limits-from-namespace' should set 'resources.limits.cpu'", "Namespace": "builtin.kubernetes.KSV011", "Query": "data.builtin.kubernetes.KSV011.deny", "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011", "References": ["https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits", "https://avd.aquasec.com/misconfig/ksv011"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "res-004-2-no-cpu-limits.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV011", "Title": "CPU not limited", "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.", "Message": "Container 'app' of Deployment 'res-004-2-no-cpu-limits' should set 'resources.limits.cpu'", "Namespace": "builtin.kubernetes.KSV011", "Query": "data.builtin.kubernetes.KSV011.deny", "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.", "Severity": "LOW", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv011", "References": ["https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits", "https://avd.aquasec.com/misconfig/ksv011"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 73, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "res-005-1-default-ephemeral-storage-requests-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-005-2-no-ephemeral-storage-requests.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-006-1-default-ephemeral-storage-limits-from-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-006-2-no-ephemeral-storage-limits.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-007-0-no-limitrange-object-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-007-1-no-default-cpu-request-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-007-2-no-default-cpu-limits-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-007-3-no-cpu-limits-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-008-1-no-default-memory-request-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-008-2-no-default-memory-limits-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-008-3-no-default-memory-limits-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-009-1-no-resource-quota-applied-to-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "res-009-2-no-hard-quotas-defined-in-resourcequota-for-namespace.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "sc-001-1-imagepullpolicy-defaults-to-always.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "sc-001-2-no-proper-imagepullpolicy-set.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "sc-001-3-no-proper-imagepullpolicy-set.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "sc-002-1-tag-instead-of-digest-is-fine.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}, {"Target": "sc-002-2-using-latest-image-tag.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV013", "Title": "Image tag ':latest' used", "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.", "Message": "Container 'app' of Deployment 'sc-002-2-using-latest-image-tag' should specify an image tag", "Namespace": "builtin.kubernetes.KSV013", "Query": "data.builtin.kubernetes.KSV013.deny", "Resolution": "Use a specific container image tag that is not 'latest'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013", "References": ["https://kubernetes.io/docs/concepts/configuration/overview/#container-images", "https://avd.aquasec.com/misconfig/ksv013"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 74, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "sc-002-3-no-explicit-tag.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 1, "Exceptions": 0}, "Misconfigurations": [{"Type": "Kubernetes Security Check", "ID": "KSV013", "Title": "Image tag ':latest' used", "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.", "Message": "Container 'app' of Deployment 'sc-002-3-no-explicit-tag' should specify an image tag", "Namespace": "builtin.kubernetes.KSV013", "Query": "data.builtin.kubernetes.KSV013.deny", "Resolution": "Use a specific container image tag that is not 'latest'.", "Severity": "MEDIUM", "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv013", "References": ["https://kubernetes.io/docs/concepts/configuration/overview/#container-images", "https://avd.aquasec.com/misconfig/ksv013"], "Status": "FAIL", "Layer": {}, "CauseMetadata": {"Provider": "Kubernetes", "Service": "general", "StartLine": 39, "EndLine": 74, "Code": {"Lines": [{"Number": 39, "Content": "      affinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": true, "LastCause": false}, {"Number": 40, "Content": "        nodeAffinity:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 41, "Content": "          preferredDuringSchedulingIgnoredDuringExecution:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 42, "Content": "            - preference:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 43, "Content": "                matchExpressions:", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 44, "Content": "                  - key: node-role.kubernetes.io/control-plane", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 45, "Content": "                    operator: DoesNotExist", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 46, "Content": "              weight: 1", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": false}, {"Number": 47, "Content": "      automountServiceAccountToken: false", "IsCause": true, "Annotation": "", "Truncated": false, "FirstCause": false, "LastCause": true}, {"Number": 48, "Content": "", "IsCause": false, "Annotation": "", "Truncated": true, "FirstCause": false, "LastCause": false}]}}}]}, {"Target": "wl-001-naked-pod.yaml", "Class": "config", "Type": "kubernetes", "MisconfSummary": {"Successes": 78, "Failures": 0, "Exceptions": 0}}]}